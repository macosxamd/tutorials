Absolutely! Here's a full step-by-step **tutorial** for setting up a **Windows Server 2003 KMS (Key Management Service)**, including:

1. **Copying the `slsvc.exe` file**
2. **Creating the KMS service**
3. **Configuring the KMS DNS SRV record**

### **Full Tutorial: Setting Up KMS on Windows Server 2003**

---

### **Step 1: Copy the `slsvc.exe` File to `System32`**

In **Windows Server 2003**, the **KMS (Key Management Service)** binary (`slsvc.exe`) needs to be manually copied to `C:\Windows\System32`. Here's how you can do it:

#### 1.1. **Locate the `slsvc.exe` File**

* If you’re using the **KMS package** for Windows Server 2003 (typically from the **Volume Licensing Service Center**), the **`slsvc.exe`** file should be inside the KMS installation package.

* If you don’t have the file, you can usually find it on a **Windows Server 2003 CD/DVD** under the **I386** folder or **extracted KMS files**.

#### 1.2. **Copy `slsvc.exe` to `System32`**

* Copy `slsvc.exe` from its location to the **`C:\Windows\System32\`** folder:

  Example using **Command Prompt**:

  ```cmd
  copy D:\kms\slsvc.exe C:\Windows\System32\slsvc.exe
  ```

  * Replace `D:\kms\slsvc.exe` with the actual path where you found the `slsvc.exe` file.

* Ensure **administrator** privileges are granted, as you'll need elevated access to copy files into the `System32` directory.

---

### **Step 2: Create the KMS Service**

Once the **`slsvc.exe`** file is in place, you need to create a service for it using the `sc` command.

#### 2.1. **Open Command Prompt as Administrator**

* Press **Win + R**, type `cmd`, then press **Ctrl + Shift + Enter** to run it as **Administrator**.

#### 2.2. **Create the Service**

Use the following command to create the **KMS service** (called "Software Protection"):

```cmd
sc create "Software Protection" binPath= "C:\Windows\System32\slsvc.exe" start= auto obj= "NT AUTHORITY\NetworkService"
```

* **"Software Protection"**: This is the display name for the service.
* **`binPath=`**: Specifies the path to the `slsvc.exe` executable.
* **`start= auto`**: Configures the service to start automatically when the system boots.
* **`obj= "NT AUTHORITY\NetworkService"`**: Runs the service under the **NetworkService** account, which is appropriate for KMS because it needs network access but minimal permissions.

### **Step 3: Add a Description to the Service** (Optional)

To help identify the service, you can add a description:

```cmd
sc description "Software Protection" "Provides software protection and licensing functionality."
```

---

### **Step 4: Start the Service**

Now that the service is created, you can start it with the following command:

```cmd
net start "Software Protection"
```

* You should see a message confirming that the service has started successfully.

Alternatively, you can open **Services.msc** (`services.msc` in the Run dialog) and manually start the service from the **Services** window.

---

### **Step 5: Verify the Service Creation**

To verify the service was created and is running correctly, use the following command:

```cmd
sc qc "Software Protection"
```

This will display details about the service, such as the binary path, startup type, and the user account it’s running under.

You can also use the **`net start`** command to check if the service is running:

```cmd
net start
```

Look for the **Software Protection** service in the list of running services.

---

### **Step 6: Configure the KMS DNS SRV Record**

#### 6.1. **Open DNS Manager**

* On your **DNS server**, press `Win + R`, type `dnsmgmt.msc`, and press Enter to open the **DNS Manager**.
* In the left pane, expand the **Forward Lookup Zones**, and select the domain for which you want to configure the KMS server (e.g., `yourdomain.local`).

#### 6.2. **Create the SRV Record**

1. Right-click on the domain (e.g., `yourdomain.local`) and choose **Other New Records…**
2. Scroll down and choose **Service Location (SRV)**, then click **Create Record…**

#### 6.3. **Enter SRV Record Details**

In the **New Resource Record** window, fill in the following details:

* **Service**: `_vlmcs`
* **Protocol**: `_tcp`
* **Port number**: `1688`
* **Host offering this service**: `kms.yourdomain.local` (or use the actual Fully Qualified Domain Name (FQDN) of your KMS host).

Example:

| Field                          | Value                                               |
| ------------------------------ | --------------------------------------------------- |
| **Service**                    | `_vlmcs`                                            |
| **Protocol**                   | `_tcp`                                              |
| **Port number**                | `1688`                                              |
| **Host offering this service** | `kms.yourdomain.local` (replace with your KMS FQDN) |

Click **OK**, then **Done**.

---

### **Step 7: Verify the SRV Record**

To verify the DNS record was created successfully, run the following command from any **domain-joined client**:

```cmd
nslookup -type=srv _vlmcs._tcp.yourdomain.local
```

You should see the KMS server's FQDN listed in the output. For example:

```text
Server:  dc01.yourdomain.local
Address:  10.0.0.10

_vlmcs._tcp.yourdomain.local  SRV service location:
          priority = 0
          weight = 0
          port = 1688
          svr hostname = kms.yourdomain.local
```

If the DNS record is configured correctly, clients will be able to automatically find the KMS server and activate themselves.

---

### **Step 8: Confirm KMS Service is Running**

Finally, ensure that the **Software Protection Service** (`sppsvc`) is running and listening on port **1688**.

Run the following command on the **KMS host**:

```cmd
net start sppsvc
```

To confirm the service is listening on port **1688**, use:

```cmd
netstat -ano | find "1688"
```

You should see output indicating that **port 1688** is open and listening.

---

### **Step 9: Test Activation**

Now, on a **domain-joined client**, you can test if **KMS activation** is working by running the following command:

```cmd
slmgr.vbs /ato
```

This command attempts to activate Windows using the KMS server. If everything is configured correctly, the system will successfully activate via your KMS server.

---

### **Recap**

1. **Copy `slsvc.exe` to `System32`**: Ensure the file is in place before continuing.
2. **Create the KMS service**: Use `sc create` to register the service.
3. **Add a description** (optional): To clarify the service's purpose.
4. **Start the service**: Run `net start` to launch the service.
5. **Configure the DNS SRV record**: Set up the `_vlmcs` record in DNS.
6. **Verify**: Confirm the KMS service is running and DNS resolution works.
7. **Test activation**: Use `slmgr.vbs /ato` on clients to activate via KMS.

---

If you have any issues or need further clarification on any of the steps, feel free to ask!
